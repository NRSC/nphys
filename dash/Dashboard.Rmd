---
title: "LTD Dashboard"
runtime: shiny
output: html_document
---

```{r setup, include=FALSE}
#------------------ Packages ------------------
library(flexdashboard)
library(nphys)
library(plotly)
`%>%` <- magrittr::`%>%`
load("~/nphys/data/field.rda")
```

```{r}
lf <- list.files("data", pattern = "rda", recursive = FALSE, full.names = TRUE)
tst <- fileD(lf)
tst <- gsub(".rda", "", fileD(lf))

#INPUT = tst[1] 

#lf[grep(INPUT, lf)]

 
# selectInput("fieldSlice", label = "Choose Slice", choices = tst, selected = "field")
# 
# 
selectInput("fieldSlice", label = "Select slice:",
              choices = tst, selected = tst[1])

# sliderInput("bw_adjust", label = "Bandwidth adjustment:",
#               min = 0.2, max = 2, value = 1, step = 0.2)

```


Column {data-width=1000}
-----------------------------------------------------------------------

### Chart A

Traces on a plotly for interaction

```{r}




output$plot <- renderPlotly({

rda = lf[grep(input$fieldSlice, lf)]
load(rda)  
  
plotly::plot_ly(
        data = data.frame(field$traces),
        x = ~ ms,
        y = ~ Bl_Avg,
        type = "scatter",
        mode = "markers"
    )
})


# ouput$plot <- renderPlot(
#   
# xA = list(
#   title = "Time (ms)"
# ),
# yA = list(
#   range = c(-1.2,0.1),
#   title = "mV"
# ),
# 
# plotly::plot_ly(
#         data = data.frame(field$traces),
#         x = ~ ms,
#         y = ~ Bl_Avg,
#         type = "scatter",
#         mode = "markers"
#     ) %>%
#     plotly::layout(xaxis = xA, yaxis = yA)
# )
# 
# # If conditions to add or remove traces. 
# # if(Cond)
# #     pl = plotly::add_trace(x = ~ ms, y = ~ Decay_Avg)
# # if (Decay)
# #     pl = plotly::add_trace(x = ~ ms, y = ~ Cond_Avg)
# 
# 
#   
# #pl

```


